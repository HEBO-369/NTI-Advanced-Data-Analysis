
--1.Display the Department id, name and id and the name of its manager.
select 
Dnum,Dname,SSN,Fname+' '+Lname as full_name
from Departments , Employee
where Dnum = Dno
--2.Display the name of the departments and the name of the projects under its control.
select 
Dname,Pname
from Project,Departments
where Project.Dnum= Departments.Dnum
--3.Display the full data about all the dependence associated with the name of the employee they depend on him/her.
select  
Dependent.ESSN,Dependent.Dependent_name,Dependent.Bdate,Dependent.Sex,
Fname + ' ' + Lname as depend_on
from Dependent , Employee
where ESSN = Employee.SSN
--4.Display the Id, name and location of the projects in Cairo or Alex city.
select 
Pnumber,Pname,Plocation
from Project
where City = 'Cairo' or City = 'Alex'
--5.Display the Projects full data of the projects with a name starts with "a" letter
select *
from Project
where Pname like 'a%'
--6.display all the employees in department 30 whose salary from 1000 to 2000 LE monthly
select * 
from Employee
where Dno=30 and ( Salary between 1000 and 2000 )
--7.Retrieve the names of all employees in department 10 who works more than or equal10 hours per week on "AL Rabwah" project.
select 
fname+' '+lname,Dno,project.Pname,Works_for.Hours
from Employee
inner join Works_for on Works_for.ESSn = Employee.SSN
inner join Project on Works_for.Pno = Project.Pnumber
where Dno=10 and Hours >=10 and Pname ='AL Rabwah'
--8.Find the names of the employees who directly supervised with Kamel Mohamed.
select 
t.fname+' '+t.lname
from Employee as t
join Employee on t.SSN = Employee.Superssn
where Employee.Fname = 'Kamel' and Employee.lname = 'Mohamed'
--9.Retrieve the names of all employees and the names of the projects they are working on, sorted by the project name.
select 
fname+' ' + lname ,
Project.Pname
from Employee
inner join Departments on Departments.Dnum=Employee.Dno
inner join Project on Departments.Dnum=Project.Dnum
order by Pname
--10.For each project located in Cairo City , find the project number, 
--the controlling department name ,the department manager last name ,address and birthdate.
select
Pname,Departments.Dname,Employee.Lname,Employee.Address,Employee.Bdate
from Project
inner join Departments on project.Dnum = Departments.Dnum
inner join Employee on Departments.MGRSSN =Employee.SSN
where City ='Cairo'
--11.	Display All Data of the managers
select * 
from Employee
inner join Departments on Employee.SSN =Departments.MGRSSN
--12.Display All Employees data and the data of their dependents even if they have no dependents
select * 
from Employee , Dependent
